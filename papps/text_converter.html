<!DOCTYPE html>
<html lang="ja">
<head>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 width=%2216%22 height=%2216%22 viewBox=%220 0 16 16%22><text x=%220%22 y=%2214%22 font-size=%2216%22>&#x2728;</text></svg>" type="image/svg+xml">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MSTVN0KCF9"></script>
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'G-MSTVN0KCF9');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>全角→半角変換テキストエディタ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 25px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.2rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .header p {
            opacity: 0.9;
            font-size: 1.1rem;
        }

        .main-content {
            padding: 30px;
        }

        .editor-section {
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.3rem;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title::before {
            content: '';
            width: 4px;
            height: 20px;
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            border-radius: 2px;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 20px;
            border: 2px solid #e1e5e9;
            border-radius: 10px;
            font-size: 16px;
            font-family: 'Consolas', 'Monaco', monospace;
            line-height: 1.6;
            resize: vertical;
            transition: all 0.3s ease;
            background: #fafafa;
        }

        textarea:focus {
            outline: none;
            border-color: #4facfe;
            background: white;
            box-shadow: 0 0 0 3px rgba(79, 172, 254, 0.1);
        }

        .controls {
            display: flex;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
            align-items: center;
        }

        .btn {
            padding: 12px 24px;
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: linear-gradient(45deg, #3d8bfe, #00d4fe);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.3);
        }

        .btn:active {
            transform: translateY(0);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #667eea, #764ba2);
        }

        .btn-secondary:hover {
            background: linear-gradient(45deg, #5a6fd8, #6a4190);
        }

        .stats {
            display: flex;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .stat-item {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #4facfe;
            flex: 1;
            min-width: 150px;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            margin-bottom: 5px;
        }

        .stat-value {
            font-size: 20px;
            font-weight: 700;
            color: #333;
        }

        .example {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
        }

        .example-title {
            font-weight: 600;
            color: #495057;
            margin-bottom: 10px;
        }

        .example-text {
            font-family: 'Consolas', 'Monaco', monospace;
            background: white;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #dee2e6;
            margin: 10px 0;
        }

        .animation-container {
            position: relative;
            overflow: hidden;
        }

        .processing {
            background: linear-gradient(45deg, #ff9a9e, #fecfef);
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .main-content {
                padding: 20px;
            }
            
            .controls {
                flex-direction: column;
                align-items: stretch;
            }
            
            .btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>✨ 全角→半角変換エディタ</h1>
            <p>全角英数字と記号を半角に一括変換</p>
        </div>

        <div class="main-content">
            <div class="editor-section">
                <div class="section-title">📝 入力テキスト</div>
                <div class="animation-container">
                    <textarea id="inputText" placeholder="ここに変換したいテキストを入力してください...&#10;例：ＡＢＣＤ１２３４　ａｂｃｄ"></textarea>
                </div>
                
                <div class="controls">
                    <button class="btn" onclick="convertText()">
                        🔄 全角→半角変換
                    </button>
                    <button class="btn btn-secondary" onclick="clearAll()">
                        🗑️ クリア
                    </button>
                    <button class="btn btn-secondary" onclick="copyResult()">
                        📋 結果をコピー
                    </button>
                </div>

                <div class="stats" id="stats">
                    <div class="stat-item">
                        <div class="stat-label">文字数</div>
                        <div class="stat-value" id="charCount">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">変換対象</div>
                        <div class="stat-value" id="convertibleCount">0</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-label">行数</div>
                        <div class="stat-value" id="lineCount">0</div>
                    </div>
                </div>
            </div>

            <div class="editor-section">
                <div class="section-title">✅ 変換結果</div>
                <div class="animation-container">
                    <textarea id="outputText" readonly placeholder="変換結果がここに表示されます..."></textarea>
                </div>
            </div>

            <div class="example">
                <div class="example-title">📚 変換例</div>
                <div class="example-text">
                    <strong>変換前：</strong> ＡＢＣＤＥ１２３４５　ａｂｃｄｅ（＾＿＾）！？　２５℃<br>
                    <strong>変換後：</strong> ABCDE12345 abcde(^_^)!? 25°C
                </div>
                <div style="margin-top: 15px; font-size: 14px; color: #666;">
                    ※ 全角英数字（A-Z、a-z、0-9）、全角スペース（　）、全角記号が半角に変換されます<br>
                    　 対象記号：！"＃＄％＆'（）＊＋，－．／：；＜＝＞？＠［￥］＾＿｀｛｜｝～℃<br>
                </div>
            </div>
        </div>
    </div>

    <script>
        /**
         * テキストコンバーター アプリケーション
         * 全角文字を半角文字に変換する機能を提供
         */
        
        // ==================== 定数定義 ====================
        const CONVERTER_CONFIG = {
            // 変換マッピング
            FULL_WIDTH_CHARS: {
                // 全角英数字の範囲
                ALPHANUMERIC: /[Ａ-Ｚａ-ｚ０-９]/g,
                // 全角記号の範囲
                SYMBOLS: /[！"＃＄％＆'（）＊＋，－．／：；＜＝＞？＠［￥］＾＿｀｛｜｝～]/g,
                // 全角スペース
                SPACE: /　/g,
                // 全角度記号
                CELSIUS: /℃/g
            },
            
            // Unicode オフセット（全角→半角変換用）
            UNICODE_OFFSET: 0xFEE0,
            
            // UI要素のID
            ELEMENTS: {
                INPUT: 'inputText',
                OUTPUT: 'outputText',
                CHAR_COUNT: 'charCount',
                LINE_COUNT: 'lineCount',
                CONVERTIBLE_COUNT: 'convertibleCount'
            },
            
            // 通知設定
            NOTIFICATION: {
                DURATION: 3000,
                ANIMATION_DURATION: 300,
                STYLES: {
                    success: 'linear-gradient(45deg, #56ab2f, #a8e6cf)',
                    error: 'linear-gradient(45deg, #ff416c, #ff4b2b)',
                    info: 'linear-gradient(45deg, #4facfe, #00f2fe)'
                }
            },
            
            // サンプルテキスト
            SAMPLE_TEXT: 'ＨＥＬＬＯ　ＷＯＲＬＤ！\nこんにちは　１２３４５（＾＿＾）\nＡＢＣＤＥ＋ａｂｃｄｅ＝？？？\n今日の気温は２５℃です'
        };

        // ==================== DOM 要素取得 ====================
        const Elements = {
            get input() { return document.getElementById(CONVERTER_CONFIG.ELEMENTS.INPUT); },
            get output() { return document.getElementById(CONVERTER_CONFIG.ELEMENTS.OUTPUT); },
            get charCount() { return document.getElementById(CONVERTER_CONFIG.ELEMENTS.CHAR_COUNT); },
            get lineCount() { return document.getElementById(CONVERTER_CONFIG.ELEMENTS.LINE_COUNT); },
            get convertibleCount() { return document.getElementById(CONVERTER_CONFIG.ELEMENTS.CONVERTIBLE_COUNT); }
        };

        // ==================== 文字変換ユーティリティ ====================
        const CharacterConverter = {
            /**
             * 全角文字を半角文字に変換
             * @param {string} text - 変換対象のテキスト
             * @returns {string} 変換後のテキスト
             */
            convertToHalfWidth(text) {
                if (!text || typeof text !== 'string') return '';
                
                return text
                    // 全角英数字を半角に変換
                    .replace(CONVERTER_CONFIG.FULL_WIDTH_CHARS.ALPHANUMERIC, this._convertCharCode)
                    // 全角記号を半角に変換
                    .replace(CONVERTER_CONFIG.FULL_WIDTH_CHARS.SYMBOLS, this._convertCharCode)
                    // 全角スペースを半角スペースに変換
                    .replace(CONVERTER_CONFIG.FULL_WIDTH_CHARS.SPACE, ' ')
                    // 全角度記号を半角度記号+Cに変換
                    .replace(CONVERTER_CONFIG.FULL_WIDTH_CHARS.CELSIUS, '°C');
            },
            
            /**
             * 文字コードを利用した変換（内部関数）
             * @param {string} char - 変換対象の文字
             * @returns {string} 変換後の文字
             */
            _convertCharCode(char) {
                return String.fromCharCode(char.charCodeAt(0) - CONVERTER_CONFIG.UNICODE_OFFSET);
            },
            
            /**
             * 変換可能な文字数をカウント
             * @param {string} text - 対象テキスト
             * @returns {number} 変換可能な文字数
             */
            getConvertibleCount(text) {
                if (!text) return 0;
                
                const matches = text.match(/[Ａ-Ｚａ-ｚ０-９　！"＃＄％＆'（）＊＋，－．／：；＜＝＞？＠［￥］＾＿｀｛｜｝～℃]/g);
                return matches ? matches.length : 0;
            }
        };

        // ==================== 統計情報管理 ====================
        const StatsManager = {
            /**
             * 統計情報を更新
             */
            update() {
                const inputText = Elements.input?.value || '';
                
                const stats = {
                    charCount: inputText.length,
                    lineCount: inputText.split('\n').length,
                    convertibleCount: CharacterConverter.getConvertibleCount(inputText)
                };
                
                this._updateUI(stats);
            },
            
            /**
             * UIに統計情報を反映（内部関数）
             * @param {Object} stats - 統計情報
             */
            _updateUI(stats) {
                if (Elements.charCount) Elements.charCount.textContent = stats.charCount;
                if (Elements.lineCount) Elements.lineCount.textContent = stats.lineCount;
                if (Elements.convertibleCount) Elements.convertibleCount.textContent = stats.convertibleCount;
            }
        };

        // ==================== 通知システム ====================
        const NotificationManager = {
            /**
             * 通知を表示
             * @param {string} message - 表示メッセージ
             * @param {string} type - 通知タイプ（success, error, info）
             */
            show(message, type = 'info') {
                this._removeExisting();
                const notification = this._create(message, type);
                this._display(notification);
            },
            
            /**
             * 既存の通知を削除（内部関数）
             */
            _removeExisting() {
                const existing = document.querySelector('.notification');
                if (existing) existing.remove();
            },
            
            /**
             * 通知要素を作成（内部関数）
             * @param {string} message - メッセージ
             * @param {string} type - タイプ
             * @returns {HTMLElement} 通知要素
             */
            _create(message, type) {
                const notification = document.createElement('div');
                notification.className = `notification ${type}`;
                notification.textContent = message;
                
                const styles = CONVERTER_CONFIG.NOTIFICATION.STYLES[type] || CONVERTER_CONFIG.NOTIFICATION.STYLES.info;
                
                notification.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    padding: 15px 20px;
                    border-radius: 8px;
                    color: white;
                    font-weight: 600;
                    z-index: 1000;
                    animation: slideIn 0.3s ease-out;
                    max-width: 300px;
                    word-wrap: break-word;
                    background: ${styles};
                `;
                
                return notification;
            },
            
            /**
             * 通知を表示・自動削除（内部関数）
             * @param {HTMLElement} notification - 通知要素
             */
            _display(notification) {
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.style.animation = 'slideOut 0.3s ease-in';
                    setTimeout(() => {
                        if (notification.parentNode) {
                            notification.parentNode.removeChild(notification);
                        }
                    }, CONVERTER_CONFIG.NOTIFICATION.ANIMATION_DURATION);
                }, CONVERTER_CONFIG.NOTIFICATION.DURATION);
            }
        };

        // ==================== アプリケーション制御 ====================
        const ConverterApp = {
            /**
             * テキスト変換を実行
             */
            async convertText() {
                try {
                    const inputText = Elements.input?.value || '';
                    const outputElement = Elements.output;
                    
                    if (!outputElement) {
                        throw new Error('出力要素が見つかりません');
                    }
                    
                    // アニメーション開始
                    this._startProcessingAnimation(outputElement);
                    
                    // 非同期で変換処理を実行
                    await this._performConversion(inputText, outputElement);
                    
                } catch (error) {
                    console.error('変換エラー:', error);
                    NotificationManager.show('❌ 変換中にエラーが発生しました', 'error');
                }
            },
            
            /**
             * 変換処理を実行（内部関数）
             * @param {string} inputText - 入力テキスト
             * @param {HTMLElement} outputElement - 出力要素
             */
            async _performConversion(inputText, outputElement) {
                return new Promise((resolve) => {
                    setTimeout(() => {
                        const convertedText = CharacterConverter.convertToHalfWidth(inputText);
                        outputElement.value = convertedText;
                        
                        // アニメーション終了
                        this._stopProcessingAnimation(outputElement);
                        
                        // 結果通知
                        const hasChanges = inputText !== convertedText;
                        const message = hasChanges 
                            ? '✅ 変換完了！' 
                            : 'ℹ️ 変換対象の文字が見つかりませんでした';
                        const type = hasChanges ? 'success' : 'info';
                        
                        NotificationManager.show(message, type);
                        resolve();
                    }, 500);
                });
            },
            
            /**
             * 処理中アニメーションを開始（内部関数）
             * @param {HTMLElement} element - 対象要素
             */
            _startProcessingAnimation(element) {
                element.parentElement?.classList.add('processing');
            },
            
            /**
             * 処理中アニメーションを停止（内部関数）
             * @param {HTMLElement} element - 対象要素
             */
            _stopProcessingAnimation(element) {
                element.parentElement?.classList.remove('processing');
            },
            
            /**
             * 全てのフィールドをクリア
             */
            clearAll() {
                if (Elements.input) Elements.input.value = '';
                if (Elements.output) Elements.output.value = '';
                StatsManager.update();
                NotificationManager.show('🗑️ クリアしました', 'info');
            },
            
            /**
             * 結果をクリップボードにコピー
             */
            async copyResult() {
                try {
                    const outputText = Elements.output?.value?.trim();
                    
                    if (!outputText) {
                        NotificationManager.show('❌ コピーする内容がありません', 'error');
                        return;
                    }
                    
                    // モダンなクリップボードAPIを優先使用
                    if (navigator.clipboard && window.isSecureContext) {
                        await navigator.clipboard.writeText(outputText);
                    } else {
                        // フォールバック（古いブラウザ対応）
                        Elements.output.select();
                        document.execCommand('copy');
                    }
                    
                    NotificationManager.show('📋 クリップボードにコピーしました！', 'success');
                    
                } catch (error) {
                    console.error('コピーエラー:', error);
                    NotificationManager.show('❌ コピーに失敗しました', 'error');
                }
            }
        };

        // ==================== イベント管理 ====================
        const EventManager = {
            /**
             * 全てのイベントリスナーを初期化
             */
            init() {
                this._setupInputEvents();
                this._setupKeyboardShortcuts();
                this._setupAnimationStyles();
            },
            
            /**
             * 入力イベントを設定（内部関数）
             */
            _setupInputEvents() {
                Elements.input?.addEventListener('input', () => {
                    StatsManager.update();
                });
            },
            
            /**
             * キーボードショートカットを設定（内部関数）
             */
            _setupKeyboardShortcuts() {
                Elements.input?.addEventListener('keydown', (e) => {
                    if (e.ctrlKey && e.key === 'Enter') {
                        e.preventDefault();
                        ConverterApp.convertText();
                    }
                });
            },
            
            /**
             * アニメーションスタイルを追加（内部関数）
             */
            _setupAnimationStyles() {
                const style = document.createElement('style');
                style.textContent = `
                    @keyframes slideIn {
                        from { transform: translateX(100%); opacity: 0; }
                        to { transform: translateX(0); opacity: 1; }
                    }
                    @keyframes slideOut {
                        from { transform: translateX(0); opacity: 1; }
                        to { transform: translateX(100%); opacity: 0; }
                    }
                `;
                document.head.appendChild(style);
            }
        };

        // ==================== アプリケーション初期化 ====================
        const AppInitializer = {
            /**
             * アプリケーションを初期化
             */
            init() {
                this._setupEvents();
                this._loadSampleText();
                this._updateInitialStats();
            },
            
            /**
             * イベントリスナーを設定（内部関数）
             */
            _setupEvents() {
                EventManager.init();
            },
            
            /**
             * サンプルテキストを読み込み（内部関数）
             */
            _loadSampleText() {
                const inputElement = Elements.input;
                if (inputElement && !inputElement.value.trim()) {
                    inputElement.value = CONVERTER_CONFIG.SAMPLE_TEXT;
                }
            },
            
            /**
             * 初期統計を更新（内部関数）
             */
            _updateInitialStats() {
                StatsManager.update();
            }
        };

        // ==================== グローバル関数（HTML から呼び出し用） ====================
        
        /**
         * テキスト変換を実行（グローバル関数）
         */
        function convertText() {
            ConverterApp.convertText();
        }
        
        /**
         * 全てクリア（グローバル関数）
         */
        function clearAll() {
            ConverterApp.clearAll();
        }
        
        /**
         * 結果をコピー（グローバル関数）
         */
        function copyResult() {
            ConverterApp.copyResult();
        }

        // ==================== アプリケーション開始 ====================
        document.addEventListener('DOMContentLoaded', () => {
            AppInitializer.init();
        });

    </script>
</body>
</html>